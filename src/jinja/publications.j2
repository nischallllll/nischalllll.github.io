<!-- publications.j2 -->
<article class="publications" data-page="publications">
  <header>
    <h2 class="h2 article-title">{{publications.HEADER.label}}</h2>
  </header>
  <section class="publications-section">
    <ul class="filter-list">
      <li class="filter-item">
        <button class="active" data-filter-btn>All</button>
      </li>
      {% set all_categories = [] %}
      {% for pub in publications.PUBLICATIONS %}
        {% if pub.category is string %}
          {% set _ = all_categories.append(pub.category) %}
        {% else %}
          {% for cat in pub.category %}
            {% set _ = all_categories.append(cat) %}
          {% endfor %}
        {% endif %}
      {% endfor %}
      {% set categories = all_categories | unique | list %}
      {% for category in categories %}
      <li class="filter-item">
        <button data-filter-btn>{{category}}</button>
      </li>
      {% endfor %}
    </ul>
    <div class="filter-select-box">
      <button class="filter-select" data-select>
        <div class="select-value" data-selecct-value>Select category</div>
        <div class="select-icon">
          <ion-icon name="chevron-down"></ion-icon>
        </div>
      </button>
      <ul class="select-list">
        <li class="select-item">
          <button data-select-item>All</button>
        </li>
        {% for category in categories %}
        <li class="select-item">
          <button data-select-item>{{category}}</button>
        </li>
        {% endfor %}
      </ul>
    </div>
    <ul class="publication-list">
      {% for item in publications.PUBLICATIONS %}
      <li class="publication-item active" 
          data-filter-item 
          {% if item.category is string %}
            data-category="{{item.category | lower}}"
          {% else %}
            data-category="{% for cat in item.category %}{{cat | lower}}{% if not loop.last %} {% endif %}{% endfor %}"
          {% endif %}>
        {% if item.url %}
        <a href="{{item.url}}" target="_blank">
        {% else %}
        <div class="publication-item-inner">
        {% endif %}
          <figure class="publication-img">
            <div class="publication-item-icon-box">
              <ion-icon name="document-text-outline"></ion-icon>
            </div>
            <img src="{{item.image}}" alt="{{item.title}}" loading="lazy">
          </figure>
          <div class="publication-content">
            <h3 class="publication-title">{{item.title}}</h3>
            <p class="publication-authors">{{item.authors}}</p>
            <p class="publication-journal">{{item.journal}} ({{item.year}})</p>
            <div class="publication-categories">
              {% if item.category is string %}
                <span class="publication-category">{{item.category}}</span>
              {% else %}
                {% for cat in item.category %}
                  <span class="publication-category">{{cat}}</span>
                {% endfor %}
              {% endif %}
            </div>
          </div>
        {% if item.url %}
        </a>
        {% else %}
        </div>
        {% endif %}
      </li>
      {% endfor %}
    </ul>
  </section>
</article>
