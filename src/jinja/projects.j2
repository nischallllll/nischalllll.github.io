<!-- portfolio.j2 -->
<article class="portfolio" data-page="portfolio">
  <header>
    <h2 class="h2 article-title">{{projects.HEADER.label}}</h2>
  </header>
  <section class="projects">
    <ul class="filter-list">
      <li class="filter-item">
        <button class="active" data-filter-btn>All</button>
      </li>
      {# Flatten all categories into a single list #}
      {% set all_categories = [] %}
      {% for project in projects.PROJECTS %}
        {% if project.category is string %}
          {% set _ = all_categories.append(project.category) %}
        {% else %}
          {% for cat in project.category %}
            {% set _ = all_categories.append(cat) %}
          {% endfor %}
        {% endif %}
      {% endfor %}
      {% set categories = all_categories | unique | list %}
      {% for category in categories %}
      <li class="filter-item">
        <button data-filter-btn>{{category}}</button>
      </li>
      {% endfor %}
    </ul>
    <div class="filter-select-box">
      <button class="filter-select" data-select>
        <div class="select-value" data-selecct-value>Select category</div>
        <div class="select-icon">
          <ion-icon name="chevron-down"></ion-icon>
        </div>
      </button>
      <ul class="select-list">
        <li class="select-item">
          <button data-select-item>All</button>
        </li>
        {% for category in categories %}
        <li class="select-item">
          <button data-select-item>{{category}}</button>
        </li>
        {% endfor %}
      </ul>
    </div>
      <ul class="project-list">
        {% for item in projects.PROJECTS %}
          {% set categories_list = item.category if item.category is iterable and not item.category is string else [item.category] %}
          <li class="project-item  active" data-filter-item data-category="{{ categories_list | join(' ') | lower }}">
            <a href="{{item.url}}" target="_blank">
              <figure class="project-img">
                <div class="project-item-icon-box">
                  <ion-icon name="eye-outline"></ion-icon>
                </div>
                <img src="{{item.image}}" alt="{{item.title}}" loading="lazy">
              </figure>
              <h3 class="project-title">{{item.title}}</h3>
              <p class="project-category">{{ categories_list | join(', ') }}</p>
            </a>
          </li>
        {% endfor %}
      </ul>
  </section>
</article>